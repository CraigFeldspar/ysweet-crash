# y-serve

`y-serve` is a standalone yjs server with batteries included:
- [x] Persistence to local disk, NFS, or S3-compatible blob storage (no database required!)
- [x] PASETO-based authorization system.
- [ ] Built-in debug interface.
- [ ] History API.

## Usage

### Install the server

    cargo install --path=y-serve

### Run a local server

You can run `y-serve` locally like this:

    y-serve serve ./data

This will use `./data` in the local directory as the document store and serve on localhost:8080.

### Use a bearer token

A bearer token can be used to authenticate requests from your **server**. It can be any string that you keep secret.

    y-serve serve ./data --bearer-token "my-bearer-token"

The server expects that any request _except_ for a WebSocket connection to include the same string as a bearer token
header. (WebSocket connections are established from the client, which instead uses client tokens.)

### Use client tokens

In addition to bearer tokens, client tokens should be used to authenticate requests from your **client**. Client tokens
are generated by the server as a result of a (bearer-token authenticated) request. Client tokens are scoped to a
particular document.

Client tokens are signed with a (symmetric) private key. To generate a new private key, run:

    y-serve gen-token

Then, run the server with:

    y-serve serve ./data --bearer-token "my-bearer-token" --paseto [result of gen-token]

